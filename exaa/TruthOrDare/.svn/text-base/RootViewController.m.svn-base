

#import "RootViewController.h"
#import "TruthAndDareList.h"
#import "SettingsViewController.h"
#import "UserDefaultSettings.h"
#import "PlayViewController.h"
#import "Popup.h"

@implementation RootViewController

@synthesize arrPlayers;
@synthesize arrPlayersGender;
@synthesize tblPlayer;
@synthesize txtPlayerName;
@synthesize btnAddPlayer;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) 
    {
        
    }
    return self;
}
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    
}
#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    
    self.navigationController.navigationBar.hidden = YES;
    tblPlayer.backgroundColor = [UIColor clearColor];
    arrPlayers = [[NSMutableArray alloc] init];
    arrPlayersGender = [[NSMutableArray alloc] init];
    thisDevice  = [UIDevice currentDevice];
    
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        [txtPlayerName setFont:[UIFont fontWithName:@"Segoe Print" size:42.0]];
    }
    else
    {
        [txtPlayerName setFont:[UIFont fontWithName:@"Segoe Print" size:15.0]];
    }
    
    arrPlayerName = [[UserDefaultSettings sharedSetting] retrieveArray:@"Player Name"];
    if([arrPlayerName count] != 0)
    {
        for(int i=0; i<[arrPlayerName count]; i++)
        {
            [arrPlayers addObject:[arrPlayerName objectAtIndex:i]];
        }
    }
    arrPlayerGender = [[UserDefaultSettings sharedSetting] retrieveArray:@"Player Gender"];
    if([arrPlayerGender count] != 0)
    {
        for(int i=0; i<[arrPlayerGender count]; i++)
        {
            [arrPlayersGender addObject:[arrPlayerGender objectAtIndex:i]];
        }
    }
    
    appDelegate = (TruthOrDareAppDelegate *) [UIApplication sharedApplication].delegate;
    
    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPhone) {
        lbltitle.font=[UIFont fontWithName:@"Segoe Print" size:22];
    }
    else{
        lbltitle.font=[UIFont fontWithName:@"Segoe Print" size:42];
    }
    
}

-(void)viewWillAppear:(BOOL)animated
{
    lbltitle.text=NSLocalizedString(@"Truth or Dare", @"");
    txtPlayerName.placeholder = NSLocalizedString(@"Enter name key", @"");
    [self update_UI];
}

#pragma mark - custom methods

//Update Images method
-(void)update_UI
{
    UIImage *imgBtnPlay = nil;
    UIImage *imgBtnYes = nil;
    UIImage *imgBtnNo = nil;
    
    NSString *strPlayBtn=nil;
    NSString *strYesBtn=nil;
    NSString *strNoBtn=nil;
    
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        
        strPlayBtn = [NSString stringWithFormat:@"play_btn_iPad_%@",CurrentLang];
        strYesBtn = [NSString stringWithFormat:@"btn_yes_iPad_%@",CurrentLang];
        strNoBtn = [NSString stringWithFormat:@"btn_no_iPad_%@",CurrentLang];
        
        imgBtnPlay =[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:strPlayBtn ofType:@"png"]];
        imgBtnYes=[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:strYesBtn ofType:@"png"]];
        imgBtnNo=[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:strNoBtn ofType:@"png"]];
        
        [playbtn setImage:imgBtnPlay forState:UIControlStateNormal];
        [btnAddYes setImage:imgBtnYes forState:UIControlStateNormal];
        [btnChangeYes setImage:imgBtnYes forState:UIControlStateNormal];
        [btnAddNo setImage:imgBtnNo forState:UIControlStateNormal];
        [btnChangeNo setImage:imgBtnNo forState:UIControlStateNormal];
    }
    else
    {
        strPlayBtn = [NSString stringWithFormat:@"play_%@",CurrentLang];
        strYesBtn = [NSString stringWithFormat:@"btn_yes_%@",CurrentLang];
        strNoBtn = [NSString stringWithFormat:@"btn_no_%@",CurrentLang];
        
        imgBtnPlay =[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:strPlayBtn ofType:@"png"]];
        imgBtnYes=[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:strYesBtn ofType:@"png"]];
        imgBtnNo=[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:strNoBtn ofType:@"png"]];
        
        [playbtn setImage:imgBtnPlay forState:UIControlStateNormal];
        [btnAddYes setImage:imgBtnYes forState:UIControlStateNormal];
        [btnChangeYes setImage:imgBtnYes forState:UIControlStateNormal];
        [btnAddNo setImage:imgBtnNo forState:UIControlStateNormal];
        [btnChangeNo setImage:imgBtnNo forState:UIControlStateNormal];
    }
    
    strPlayBtn=nil;
    [strPlayBtn release];
    strYesBtn=nil;
    [strYesBtn release];
    strNoBtn=nil;
    [strNoBtn release];
}


//Add New Player method
-(IBAction)addPlayer
{
    NSString *trimmedString = [txtPlayerName.text stringByTrimmingCharactersInSet:
                               [NSCharacterSet whitespaceAndNewlineCharacterSet]];
    
    if ([trimmedString isEqualToString:@""])
    {
        [txtPlayerName resignFirstResponder];
        strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Enter player name", @"")];
        dictAlertMessage = [[NSMutableDictionary alloc] init];
        [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
        [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
        [dictAlertMessage release];
    }
    else
    {
        
        if([self checkNameExistence])
        {
            [txtPlayerName resignFirstResponder];
            
            strLocal = [[NSString alloc]initWithString:NSLocalizedString(@"Already entered", @"")];
            
            strLocal=[strLocal stringByReplacingOccurrencesOfString:@"*" withString:name];
            strAlertMessage=strLocal;
            
            dictAlertMessage = [[NSMutableDictionary alloc] init];
            [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
            [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
            txtPlayerName.text = @"";
            [dictAlertMessage release];
        }
        else
        {    
            //            NSString *strPlayerName = txtPlayerName.text;
            //            int strLen = strPlayerName.length;
            //            if(strLen > 25)
            //            {
            //                [txtPlayerName resignFirstResponder];
            //                strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Maximum 25 char key", @"")];
            //                dictAlertMessage = [[NSMutableDictionary alloc] init];
            //                [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
            //                [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
            //                [dictAlertMessage release];
            //            }
            //            else
            //            {
            BOOL onlyNumbers = NO;
            NSCharacterSet * set = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLKMNOPQRSTUVWXYZ0123456789"] invertedSet];
            
            NSPredicate *rp =  [NSPredicate predicateWithFormat:@"SELF MATCHES '[0-9*]+'"];
            if ([rp evaluateWithObject:trimmedString])
                onlyNumbers = YES;
            else
                onlyNumbers = NO;
            
            if ([trimmedString rangeOfCharacterFromSet:set].location != NSNotFound || onlyNumbers) 
            {
                [txtPlayerName resignFirstResponder];
                strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Special char key", @"")];
                dictAlertMessage = [[NSMutableDictionary alloc] init];
                [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
                [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
                [dictAlertMessage release];
            }
            else 
            {
                [txtPlayerName resignFirstResponder];
                [arrPlayers addObject:trimmedString];
                [arrPlayersGender addObject:@"Male"];
                txtPlayerName.text = @"";
                [tblPlayer reloadData];
                [FlurryAnalytics logEvent:@"PlayerAdded"];
                NSArray *arrName = [NSArray arrayWithArray:arrPlayers];
                [[UserDefaultSettings sharedSetting] storeArray:arrName withKey:@"Player Name"];
                NSArray *arrGender = [NSArray arrayWithArray:arrPlayersGender];
                [[UserDefaultSettings sharedSetting] storeArray:arrGender withKey:@"Player Gender"];
            }               
            // }
        }
    }
}

//Check Name Existence method
-(BOOL)checkNameExistence
{
    NSString *trimmedString = [txtPlayerName.text stringByTrimmingCharactersInSet:
                               [NSCharacterSet whitespaceAndNewlineCharacterSet]];
    BOOL flag=NO;
    if([arrPlayers count] != 0)
    {
        for(int i=0; i<[arrPlayers count]; i++)
        {
            //if([trimmedString isEqualToString:[arrPlayers objectAtIndex:i]])
            if(![trimmedString caseInsensitiveCompare:[arrPlayers objectAtIndex:i]])
            {
                flag = TRUE;
                name = [arrPlayers objectAtIndex:i];
                break;
            }
            else
            {
                flag = FALSE;  
            }
        }
    }
    else
    {
        flag = FALSE;
    }
    return flag;
}
//Go to Seetings screen method
-(IBAction)goToSettings
{
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        SettingsViewController *settingsObj = [[SettingsViewController alloc] initWithNibName:@"SettingsViewController_iPad" bundle:nil];
        [self.navigationController pushViewController:settingsObj animated:YES];
        [settingsObj release];
    }
    else
    {
        SettingsViewController *settingsObj = [[SettingsViewController alloc] initWithNibName:@"SettingsViewController" bundle:nil];
        [self.navigationController pushViewController:settingsObj animated:YES];
        [settingsObj release];
    }
    
    
}
-(IBAction)NobtnAction:(id)sender
{
    btnAddPlayer.userInteractionEnabled=YES;
    txtPlayerName.userInteractionEnabled=YES;
    tblPlayer.userInteractionEnabled=YES;
    settingbtn.userInteractionEnabled=YES;
    playbtn.userInteractionEnabled=YES;
    [alertview removeFromSuperview]; 
    self.view.userInteractionEnabled=YES;
    txtPlayerName.text=@""; 
    NSDictionary *dictSettings = [[UserDefaultSettings sharedSetting] retrieveDictionary:@"Settings"];
    if([dictSettings count] == 0)
    {
        NSString *strSound=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strTakesTrueInOrder=[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
        NSString *strMyDaresOnly=[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
        NSString *strAllowChangingDares=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strClean=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strDirty=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strSuperDirty =[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
        NSString *strTruthMode =[[[NSString alloc]initWithFormat:@"Off"]autorelease];
        NSString *strSpeed =[[[NSString alloc]initWithFormat:@"3"]autorelease];
        NSString *strAutoTruth =[[[NSString alloc]initWithFormat:@"6"]autorelease];
        NSString *strAutoTruthFlag=[[[NSString alloc]initWithFormat:@"YES"]autorelease];
        NSArray *objects = [NSArray arrayWithObjects:
                            strSound, 
                            strTakesTrueInOrder, 
                            strMyDaresOnly, 
                            strAllowChangingDares,
                            strClean,
                            strDirty,
                            strSuperDirty,
                            strTruthMode,
                            strSpeed,
                            strAutoTruth,
                            strAutoTruthFlag,
                            nil];
        NSArray *keys = [NSArray arrayWithObjects:@"Sound", @"Takes True In Order", @"My Dares Only", @"Allow Changing Dares", @"Clean", @"Dirty", @"Super Dirty", @"Truth Mode", @"Speed", @"Auto Truth",@"AutoTruthFlag",nil];
        
        if (dictSettings != nil)
        {
            dictSettings = nil;
        }
        dictSettings = [NSDictionary dictionaryWithObjects:objects forKeys:keys];
        [[UserDefaultSettings sharedSetting] storeDictionary:dictSettings withKey:@"Settings"];  
    }
    
    if([arrPlayers count] < 2)
    {
        strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Minimum two players", @"")];
        dictAlertMessage = [[NSMutableDictionary alloc] init];
        [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
        [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
        [dictAlertMessage release];
    }
    else
    {
        couplealerttitle.text=NSLocalizedString(@"Change Setting", @"");
        NSMutableArray *arr = [[NSMutableArray alloc] init];
        appDelegate.usedGender = arr;
        [arr release];
        //-----------
        if (appDelegate.Changesettingint==1) 
        {
            NSDictionary *dictSettings = [[UserDefaultSettings sharedSetting] retrieveDictionary:@"Settings"];
            if (dictSettings>0) 
            {
                NSString *strSuperDirty = [dictSettings objectForKey:@"Super Dirty"];
                if (([arrPlayers count]>2)&&([strSuperDirty isEqualToString:@"ON"])&&([[dictSettings valueForKey:@"Speed"]integerValue]<3)) 
                {
                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-1", @"")];
                    btnAddPlayer.userInteractionEnabled=NO;
                    txtPlayerName.userInteractionEnabled=NO;
                    tblPlayer.userInteractionEnabled=NO;
                    settingbtn.userInteractionEnabled=NO;
                    playbtn.userInteractionEnabled=NO;
                    
                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                        alertforcouple.frame=CGRectMake(45, 200, 660, 570);
                    }
                    else{
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                    }
                    
                    [textview setTextColor:[UIColor whiteColor]];
                    [couplealerttitle setTextColor:[UIColor blackColor]];
                    [self.view addSubview:alertforcouple];
                    [self.view bringSubviewToFront:alertforcouple];
                }
                else if (([arrPlayers count]>2)&&([strSuperDirty isEqualToString:@"ON"]))
                {
                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-2", @"")];
                    btnAddPlayer.userInteractionEnabled=NO;
                    txtPlayerName.userInteractionEnabled=NO;
                    tblPlayer.userInteractionEnabled=NO;
                    settingbtn.userInteractionEnabled=NO;
                    playbtn.userInteractionEnabled=NO;
                    
                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                        alertforcouple.frame=CGRectMake(45, 200, 660, 570);
                        
                    }
                    else{
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                    }
                    
                    [textview setTextColor:[UIColor whiteColor]];
                    [couplealerttitle setTextColor:[UIColor blackColor]];
                    [self.view addSubview:alertforcouple];
                    [self.view bringSubviewToFront:alertforcouple];
                }
                else if(([arrPlayers count]>2)&&([[dictSettings valueForKey:@"Speed"]integerValue]<3))
                {
                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-3", @"")];
                    btnAddPlayer.userInteractionEnabled=NO;
                    txtPlayerName.userInteractionEnabled=NO;
                    tblPlayer.userInteractionEnabled=NO;
                    settingbtn.userInteractionEnabled=NO;
                    playbtn.userInteractionEnabled=NO;
                    
                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                        alertforcouple.frame=CGRectMake(45, 200, 660, 570);
                        
                    }
                    else{
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                    }
                    
                    
                    //                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                    [textview setTextColor:[UIColor whiteColor]];
                    //                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                    [couplealerttitle setTextColor:[UIColor blackColor]];
                    //                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                    [self.view addSubview:alertforcouple];
                    [self.view bringSubviewToFront:alertforcouple]; 
                }
                else
                {
                    [self changesettings];
                }
                
            }
            
        }
        else
        {
            PlayViewController *playObj;
            if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
            {
                playObj = [[PlayViewController alloc] initWithNibName:@"PlayViewController_iPad" bundle:nil];
            }
            else
            {
                playObj = [[PlayViewController alloc] initWithNibName:@"PlayViewController" bundle:nil];
            }
            playObj.arrPlayerName = arrPlayers;
            playObj.arrPlayerGender = arrPlayersGender;
            appDelegate.stackArr = [NSMutableArray arrayWithArray:arrPlayers];
            appDelegate.stackGenderArr = [NSMutableArray arrayWithArray:arrPlayersGender];
            NSMutableArray *tempArr = [[NSMutableArray alloc] init];
            appDelegate.playerDetailsArray = tempArr;
            [tempArr release];
            
            for (int i=0; i<[arrPlayers count]; i++) 
            {
                NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
                [dict setObject:[arrPlayers objectAtIndex:i] forKey:@"Player"];
                [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"DareNumber"];
                [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"TruthNumber"];
                //------Speed--------------//
                [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"SpeedNo"];
                [appDelegate.playerDetailsArray addObject:dict];
                [dict release];
            }
            
            [self.navigationController pushViewController:playObj animated:YES];
            [playObj release];                
        }
        //-------------
    }
    if(appDelegate.arrDirtinesNumber>0)
    {
        [appDelegate.arrDirtinesNumber removeAllObjects];
    }
    appDelegate.arrDirtinesNumber=[[NSMutableArray alloc]init];
    NSString *strClean = [dictSettings objectForKey:@"Clean"];
    NSString *strDirty = [dictSettings objectForKey:@"Dirty"];
    NSString *strSuperDirty = [dictSettings objectForKey:@"Super Dirty"];
    appDelegate.dirtinessLevel = 0;
    
    if([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
        appDelegate.dirtinessLevel = 3;
    else if(([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"]) || ([strClean isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"]) || ([strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"]))
        appDelegate.dirtinessLevel = 2;
    else 
        appDelegate.dirtinessLevel = 1;
    if(appDelegate.dirtinessLevel == 1)
    {
        if([strClean isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"1"];
            [appDelegate.arrDirtinesNumber addObject:@"2"];
            [appDelegate.arrDirtinesNumber addObject:@"3"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            appDelegate.dirtystartValue=1;
            appDelegate.Dirtyvalue=3;
            appDelegate.dirtystartValueformine=1;
        }
        else if([strDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"4"];
            [appDelegate.arrDirtinesNumber addObject:@"5"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            appDelegate.Dirtyvalue=5;
            appDelegate.dirtystartValue=4;
            appDelegate.dirtystartValueformine=4;
        }
        else if([strSuperDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"6"];
            appDelegate.dirtystartValue=6;
            appDelegate.Dirtyvalue=6;
            appDelegate.dirtystartValueformine=6;
        }
        
        
        
    }
    else if(appDelegate.dirtinessLevel == 2)
    {
        if([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"1"];
            [appDelegate.arrDirtinesNumber addObject:@"2"];
            [appDelegate.arrDirtinesNumber addObject:@"3"];
            [appDelegate.arrDirtinesNumber addObject:@"4"];
            [appDelegate.arrDirtinesNumber addObject:@"5"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            appDelegate.dirtystartValue=1;
            appDelegate.Dirtyvalue=5;
            appDelegate.dirtystartValueformine=1;
        }
        else if([strClean isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"1"];
            [appDelegate.arrDirtinesNumber addObject:@"2"];
            [appDelegate.arrDirtinesNumber addObject:@"3"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"6"];
            appDelegate.dirtystartValue=1;
            appDelegate.Dirtyvalue=6;
            appDelegate.dirtystartValueformine=1;
            
            
        }
        else if([strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"4"];
            [appDelegate.arrDirtinesNumber addObject:@"5"];
            [appDelegate.arrDirtinesNumber addObject:@"6"];
            appDelegate.dirtystartValue=4;
            appDelegate.Dirtyvalue=6;
            appDelegate.dirtystartValueformine=4;
            
        }
        
    }
    else if(appDelegate.dirtinessLevel == 3)
    {
        [appDelegate.arrDirtinesNumber addObject:@"1"];
        [appDelegate.arrDirtinesNumber addObject:@"2"];
        [appDelegate.arrDirtinesNumber addObject:@"3"];
        [appDelegate.arrDirtinesNumber addObject:@"4"];
        [appDelegate.arrDirtinesNumber addObject:@"5"];
        [appDelegate.arrDirtinesNumber addObject:@"6"];
        appDelegate.dirtystartValue=1;
        appDelegate.Dirtyvalue=6;
        appDelegate.dirtystartValueformine=1;
    }
    
    
}
-(IBAction)YesbtnAction:(id)sender
{
    {
        couplealerttitle.text=NSLocalizedString(@"Change Setting", @"");
        if([self checkNameExistence])
        {
            [txtPlayerName resignFirstResponder];
            strLocal=[[NSString alloc]initWithString:NSLocalizedString(@"Already entered", @"")];
            
            strLocal=[strLocal stringByReplacingOccurrencesOfString:@"*" withString:name];
            strAlertMessage=strLocal;
            
            dictAlertMessage = [[NSMutableDictionary alloc] init];
            [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
            [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
            txtPlayerName.text = @"";
            [dictAlertMessage release];
        }
        else
        {    
            NSString *strPlayerName = txtPlayerName.text;
            int strLen = strPlayerName.length;
            if(strLen > 25)
            {
                strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Maximum 25 char key", @"")];
                dictAlertMessage = [[NSMutableDictionary alloc] init];
                [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
                [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
                [dictAlertMessage release];
                
            }
            else
            {
                BOOL onlyNumbers = NO;
                NSString *string = txtPlayerName.text;
                
                NSPredicate *rp =  [NSPredicate predicateWithFormat:@"SELF MATCHES '[0-9*]+'"];
                if ([rp evaluateWithObject:string])
                    onlyNumbers = YES;
                else
                    onlyNumbers = NO;
                
                
                
                NSCharacterSet * set = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLKMNOPQRSTUVWXYZ0123456789"] invertedSet];
                NSString *trimmedString = [string stringByTrimmingCharactersInSet:
                                           [NSCharacterSet whitespaceAndNewlineCharacterSet]];
                NSLog(@"%@",trimmedString);
                if ([trimmedString rangeOfCharacterFromSet:set].location != NSNotFound || onlyNumbers) {
                    strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Special char key", @"")];
                    dictAlertMessage = [[NSMutableDictionary alloc] init];
                    [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
                    [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
                    [dictAlertMessage release];
                }
                else {
                    [txtPlayerName resignFirstResponder];
                    [arrPlayers addObject:trimmedString];
                    [arrPlayersGender addObject:@"Male"];
                    txtPlayerName.text = @"";
                    [tblPlayer reloadData];
                    NSArray *arrName = [NSArray arrayWithArray:arrPlayers];
                    [[UserDefaultSettings sharedSetting] storeArray:arrName withKey:@"Player Name"];
                    NSArray *arrGender = [NSArray arrayWithArray:arrPlayersGender];
                    [[UserDefaultSettings sharedSetting] storeArray:arrGender withKey:@"Player Gender"];
                    NSDictionary *dictSettings = [[UserDefaultSettings sharedSetting] retrieveDictionary:@"Settings"];
                    if([dictSettings count] == 0)
                    {
                        NSString *strSound=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
                        NSString *strTakesTrueInOrder=[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
                        NSString *strMyDaresOnly=[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
                        NSString *strAllowChangingDares=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
                        NSString *strClean=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
                        NSString *strDirty=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
                        NSString *strSuperDirty =[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
                        NSString *strTruthMode =[[[NSString alloc]initWithFormat:@"Off"]autorelease];
                        NSString *strSpeed =[[[NSString alloc]initWithFormat:@"3"]autorelease];
                        NSString *strAutoTruth =[[[NSString alloc]initWithFormat:@"6"]autorelease];
                        NSString *strAutoTruthFlag=[[[NSString alloc]initWithFormat:@"YES"]autorelease];
                        NSArray *objects = [NSArray arrayWithObjects:
                                            strSound, 
                                            strTakesTrueInOrder, 
                                            strMyDaresOnly, 
                                            strAllowChangingDares,
                                            strClean,
                                            strDirty,
                                            strSuperDirty,
                                            strTruthMode,
                                            strSpeed,
                                            strAutoTruth,
                                            strAutoTruthFlag,
                                            nil];
                        NSArray *keys = [NSArray arrayWithObjects:@"Sound", @"Takes True In Order", @"My Dares Only", @"Allow Changing Dares", @"Clean", @"Dirty", @"Super Dirty", @"Truth Mode", @"Speed", @"Auto Truth",@"AutoTruthFlag",nil];
                        
                        if (dictSettings != nil)
                        {
                            dictSettings = nil;
                        }
                        dictSettings = [NSDictionary dictionaryWithObjects:objects forKeys:keys];
                        [[UserDefaultSettings sharedSetting] storeDictionary:dictSettings withKey:@"Settings"];  
                    }
                    if([arrPlayers count] < 2)
                    {
                        strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Minimum two players", @"")];// [NSString stringWithFormat:@"Minimum two players needed"];
                        dictAlertMessage = [[NSMutableDictionary alloc] init];
                        [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
                        [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
                        [dictAlertMessage release];
                    }
                    else
                    {
                        NSMutableArray *arr = [[NSMutableArray alloc] init];
                        appDelegate.usedGender = arr;
                        [arr release];
                        
                        //-----------
                        if (appDelegate.Changesettingint==1) 
                        {
                            NSDictionary *dictSettings = [[UserDefaultSettings sharedSetting] retrieveDictionary:@"Settings"];
                            if ([dictSettings count]>0) 
                            {
                                NSString *strSuperDirty = [dictSettings objectForKey:@"Super Dirty"];
                                if (([arrPlayers count]>2)&&([strSuperDirty isEqualToString:@"ON"])&&([[dictSettings valueForKey:@"Speed"]integerValue]<3)) 
                                {
                                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-1", @"")];
                                    btnAddPlayer.userInteractionEnabled=NO;
                                    txtPlayerName.userInteractionEnabled=NO;
                                    tblPlayer.userInteractionEnabled=NO;
                                    settingbtn.userInteractionEnabled=NO;
                                    playbtn.userInteractionEnabled=NO;
                                    
                                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                                        alertforcouple.frame=CGRectMake(45, 200, 660, 570);
                                    }
                                    else{
                                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                                    }
                                    [textview setTextColor:[UIColor whiteColor]];
                                    [couplealerttitle setTextColor:[UIColor blackColor]];
                                    [self.view addSubview:alertforcouple];
                                    [self.view bringSubviewToFront:alertforcouple];
                                }
                                else if (([arrPlayers count]>2)&&([strSuperDirty isEqualToString:@"ON"]))
                                {
                                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-2", @"")];
                                    btnAddPlayer.userInteractionEnabled=NO;
                                    txtPlayerName.userInteractionEnabled=NO;
                                    tblPlayer.userInteractionEnabled=NO;
                                    settingbtn.userInteractionEnabled=NO;
                                    playbtn.userInteractionEnabled=NO;
                                    
                                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                                        alertforcouple.frame=CGRectMake(45, 200, 660, 570);
                                    }
                                    else{
                                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                                    }
                                    
                                    [textview setTextColor:[UIColor whiteColor]];
                                    [couplealerttitle setTextColor:[UIColor blackColor]];
                                    [self.view addSubview:alertforcouple];
                                    [self.view bringSubviewToFront:alertforcouple];
                                }
                                else if(([arrPlayers count]>2)&&([[dictSettings valueForKey:@"Speed"]integerValue]<3))
                                {
                                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-3", @"")];
                                    btnAddPlayer.userInteractionEnabled=NO;
                                    txtPlayerName.userInteractionEnabled=NO;
                                    tblPlayer.userInteractionEnabled=NO;
                                    settingbtn.userInteractionEnabled=NO;
                                    playbtn.userInteractionEnabled=NO;
                                    
                                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                                        alertforcouple.frame=CGRectMake(45, 200, 660, 570);
                                    }
                                    else{
                                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                                    }
                                    [textview setTextColor:[UIColor whiteColor]];
                                    [couplealerttitle setTextColor:[UIColor blackColor]];
                                    [self.view addSubview:alertforcouple];
                                    [self.view bringSubviewToFront:alertforcouple]; 
                                }
                                else
                                {
                                    [self changesettings];
                                }
                            }
                            else
                            {
                                [self changesettings];
                            }
                            
                        }
                        else
                        {
                            PlayViewController *playObj;
                            if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
                            {
                                // iPad
                                playObj = [[PlayViewController alloc] initWithNibName:@"PlayViewController_iPad" bundle:nil];
                            }
                            else
                            {
                                // iPhone
                                playObj = [[PlayViewController alloc] initWithNibName:@"PlayViewController" bundle:nil];
                                
                            }
                            playObj.arrPlayerName = arrPlayers;
                            playObj.arrPlayerGender = arrPlayersGender;
                            appDelegate.stackArr = [NSMutableArray arrayWithArray:arrPlayers];
                            appDelegate.stackGenderArr = [NSMutableArray arrayWithArray:arrPlayersGender];
                            NSMutableArray *tempArr = [[NSMutableArray alloc] init];
                            appDelegate.playerDetailsArray = tempArr;
                            [tempArr release];
                            
                            for (int i=0; i<[arrPlayers count]; i++) 
                            {
                                NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
                                [dict setObject:[arrPlayers objectAtIndex:i] forKey:@"Player"];
                                [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"DareNumber"];
                                [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"TruthNumber"];
                                //------Speed--------------//
                                [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"SpeedNo"];
                                [appDelegate.playerDetailsArray addObject:dict];
                                [dict release];
                            }
                            
                            [self.navigationController pushViewController:playObj animated:YES];
                            [playObj release];
                            
                        }
                        
                        //------------
                        
                        
                    }
                    if(appDelegate.arrDirtinesNumber>0)
                    {
                        [appDelegate.arrDirtinesNumber removeAllObjects];
                    }
                    appDelegate.arrDirtinesNumber=[[NSMutableArray alloc]init];
                    NSString *strClean = [dictSettings objectForKey:@"Clean"];
                    NSString *strDirty = [dictSettings objectForKey:@"Dirty"];
                    NSString *strSuperDirty = [dictSettings objectForKey:@"Super Dirty"];
                    appDelegate.dirtinessLevel = 0;
                    
                    if([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
                        appDelegate.dirtinessLevel = 3;
                    else if(([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"]) || ([strClean isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"]) || ([strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"]))
                        appDelegate.dirtinessLevel = 2;
                    else 
                        appDelegate.dirtinessLevel = 1;
                    if(appDelegate.dirtinessLevel == 1)
                    {
                        if([strClean isEqualToString:@"ON"])
                        {
                            [appDelegate.arrDirtinesNumber addObject:@"1"];
                            [appDelegate.arrDirtinesNumber addObject:@"2"];
                            [appDelegate.arrDirtinesNumber addObject:@"3"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            appDelegate.dirtystartValue=1;
                            appDelegate.Dirtyvalue=3;
                            appDelegate.dirtystartValueformine=1;
                        }
                        else if([strDirty isEqualToString:@"ON"])
                        {
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"4"];
                            [appDelegate.arrDirtinesNumber addObject:@"5"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            appDelegate.Dirtyvalue=5;
                            appDelegate.dirtystartValue=4;
                            appDelegate.dirtystartValueformine=4;
                        }
                        else if([strSuperDirty isEqualToString:@"ON"])
                        {
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"6"];
                            appDelegate.dirtystartValue=6;
                            appDelegate.Dirtyvalue=6;
                            appDelegate.dirtystartValueformine=6;
                        }
                        
                        
                        
                    }
                    else if(appDelegate.dirtinessLevel == 2)
                    {
                        if([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"])
                        {
                            [appDelegate.arrDirtinesNumber addObject:@"1"];
                            [appDelegate.arrDirtinesNumber addObject:@"2"];
                            [appDelegate.arrDirtinesNumber addObject:@"3"];
                            [appDelegate.arrDirtinesNumber addObject:@"4"];
                            [appDelegate.arrDirtinesNumber addObject:@"5"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            appDelegate.dirtystartValue=1;
                            appDelegate.Dirtyvalue=5;
                            appDelegate.dirtystartValueformine=1;
                        }
                        else if([strClean isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
                        {
                            [appDelegate.arrDirtinesNumber addObject:@"1"];
                            [appDelegate.arrDirtinesNumber addObject:@"2"];
                            [appDelegate.arrDirtinesNumber addObject:@"3"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"6"];
                            appDelegate.dirtystartValue=1;
                            appDelegate.Dirtyvalue=6;
                            appDelegate.dirtystartValueformine=1;
                            
                            
                        }
                        else if([strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
                        {
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"0"];
                            [appDelegate.arrDirtinesNumber addObject:@"4"];
                            [appDelegate.arrDirtinesNumber addObject:@"5"];
                            [appDelegate.arrDirtinesNumber addObject:@"6"];
                            appDelegate.dirtystartValue=4;
                            appDelegate.Dirtyvalue=6;
                            appDelegate.dirtystartValueformine=4;
                            
                        }
                        
                    }
                    else if(appDelegate.dirtinessLevel == 3)
                    {
                        [appDelegate.arrDirtinesNumber addObject:@"1"];
                        [appDelegate.arrDirtinesNumber addObject:@"2"];
                        [appDelegate.arrDirtinesNumber addObject:@"3"];
                        [appDelegate.arrDirtinesNumber addObject:@"4"];
                        [appDelegate.arrDirtinesNumber addObject:@"5"];
                        [appDelegate.arrDirtinesNumber addObject:@"6"];
                        appDelegate.dirtystartValue=1;
                        appDelegate.Dirtyvalue=6;
                        appDelegate.dirtystartValueformine=1;
                    }
                }
                
                
            }               
        }
    }
    btnAddPlayer.userInteractionEnabled=YES;
    txtPlayerName.userInteractionEnabled=YES;
    tblPlayer.userInteractionEnabled=YES;
    settingbtn.userInteractionEnabled=YES;
    playbtn.userInteractionEnabled=YES;
    [alertview removeFromSuperview]; 
    self.view.userInteractionEnabled=YES; 
}

//Play method
-(IBAction)play
{
    if (![txtPlayerName.text isEqualToString:@""]) 
    {
        strLocal=[[NSString alloc]initWithString:NSLocalizedString(@"Do you want to add", @"")];
        // textview.text=[NSString stringWithFormat:@"%@ %@?",strLocal, txtPlayerName.text];
        //textview.text=[NSString stringWithFormat:@"Do you want to add %@?",txtPlayerName.text];
        strLocal=[strLocal stringByReplacingOccurrencesOfString:@"*" withString:txtPlayerName.text];
        NSLog(@"%@",strLocal);
        textview.text = strLocal;
        btnAddPlayer.userInteractionEnabled=NO;
        txtPlayerName.userInteractionEnabled=NO;
        tblPlayer.userInteractionEnabled=NO;
        settingbtn.userInteractionEnabled=NO;
        playbtn.userInteractionEnabled=NO;
        
        alerttitle.text=NSLocalizedString(@"Add name", @"");
        if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
            [textview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:40.0]];
            [alerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:40.0]];
            alertview.frame=CGRectMake(33, 400,705, 340);
            
        }
        else{
            [textview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:15.0]];
            [alerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
            alertview.frame=CGRectMake(20, 200,280, 153);
        }
        [textview setTextColor:[UIColor whiteColor]];
        [alerttitle setTextColor:[UIColor whiteColor]];
        [self.view addSubview:alertview];
        [self.view bringSubviewToFront:alertview];
    }
    else
    {
        couplealerttitle.text=NSLocalizedString(@"Change Setting", @"");
        if (appDelegate.Changesettingint==1) 
        {
            NSDictionary *dictSettings = [[UserDefaultSettings sharedSetting] retrieveDictionary:@"Settings"];
            if ([dictSettings count]>0) 
            {
                NSString *strSuperDirty = [dictSettings objectForKey:@"Super Dirty"];
                if (([arrPlayers count]>2)&&([strSuperDirty isEqualToString:@"ON"])&&([[dictSettings valueForKey:@"Speed"]integerValue]<3)) 
                {
                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-1", @"")];
                    btnAddPlayer.userInteractionEnabled=NO;
                    txtPlayerName.userInteractionEnabled=NO;
                    tblPlayer.userInteractionEnabled=NO;
                    settingbtn.userInteractionEnabled=NO;
                    playbtn.userInteractionEnabled=NO;
                    
                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                        alertforcouple.frame=CGRectMake(45, 200, 660, 570);
                    }
                    else
                    {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                        
                    }
                    
                    [textview setTextColor:[UIColor whiteColor]];
                    
                    [couplealerttitle setTextColor:[UIColor blackColor]];
                    [self.view addSubview:alertforcouple];
                    [self.view bringSubviewToFront:alertforcouple];
                }
                else if (([arrPlayers count]>2)&&([strSuperDirty isEqualToString:@"ON"]))
                {
                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-2", @"")];
                    btnAddPlayer.userInteractionEnabled=NO;
                    txtPlayerName.userInteractionEnabled=NO;
                    tblPlayer.userInteractionEnabled=NO;
                    settingbtn.userInteractionEnabled=NO;
                    playbtn.userInteractionEnabled=NO;
                    
                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                        alertforcouple.frame=CGRectMake(45,  200, 660, 570);
                        
                    }
                    else{
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                    }
                    
                    [textview setTextColor:[UIColor whiteColor]];
                    [couplealerttitle setTextColor:[UIColor blackColor]];
                    [self.view addSubview:alertforcouple];
                    [self.view bringSubviewToFront:alertforcouple];
                }
                else if(([arrPlayers count]>2)&&([[dictSettings valueForKey:@"Speed"]integerValue]<3))
                {
                    alertforcoupletextview.text=[[NSString alloc]initWithString:NSLocalizedString(@"Alert for couple textview key-3", @"")];
                    btnAddPlayer.userInteractionEnabled=NO;
                    txtPlayerName.userInteractionEnabled=NO;
                    tblPlayer.userInteractionEnabled=NO;
                    settingbtn.userInteractionEnabled=NO;
                    playbtn.userInteractionEnabled=NO;
                    
                    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad) 
                    {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:25.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:30.0]];
                        alertforcouple.frame=CGRectMake(45,  200, 660, 570);
                    }
                    else
                    {
                        [alertforcoupletextview setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:11.0]];
                        [couplealerttitle setFont:[UIFont fontWithName:@"SegoePrint-Bold" size:18.0]];
                        alertforcouple.frame=CGRectMake(25, 100,280, 268);
                    }
                    
                    [textview setTextColor:[UIColor whiteColor]];
                    [couplealerttitle setTextColor:[UIColor blackColor]];
                    [self.view addSubview:alertforcouple];
                    [self.view bringSubviewToFront:alertforcouple]; 
                }
                else
                {
                    [self changesettings];
                }
            }
            else
            {
                [self changesettings];
            }
        }
        else
        {
            [self changesettings];
        }
    }
}
-(IBAction)YesbtnActionforSetting:(id)sender
{
    btnAddPlayer.userInteractionEnabled=YES;
    txtPlayerName.userInteractionEnabled=YES;
    tblPlayer.userInteractionEnabled=YES;
    settingbtn.userInteractionEnabled=YES;
    playbtn.userInteractionEnabled=YES;
    [alertforcouple removeFromSuperview]; 
    self.view.userInteractionEnabled=YES;
    
    SettingsViewController *settingsObj;
    thisDevice = [UIDevice currentDevice];
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        settingsObj = [[SettingsViewController alloc] initWithNibName:@"SettingsViewController_iPad" bundle:nil];
    }
    else
    {
        settingsObj = [[SettingsViewController alloc] initWithNibName:@"SettingsViewController" bundle:nil];
    }
    [self.navigationController pushViewController:settingsObj animated:YES];
    [settingsObj release];
}
-(IBAction)NobtnActionforSetting:(id)sender
{
    appDelegate.Changesettingint=0;
    btnAddPlayer.userInteractionEnabled=YES;
    txtPlayerName.userInteractionEnabled=YES;
    tblPlayer.userInteractionEnabled=YES;
    settingbtn.userInteractionEnabled=YES;
    playbtn.userInteractionEnabled=YES;
    [alertforcouple removeFromSuperview]; 
    self.view.userInteractionEnabled=YES; 
    [self changesettings];
}
-(void)changesettings{
    
    NSDictionary *dictSettings = [[UserDefaultSettings sharedSetting] retrieveDictionary:@"Settings"];
    if([dictSettings count] == 0)
    {
        NSString *strSound=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strTakesTrueInOrder=[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
        NSString *strMyDaresOnly=[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
        NSString *strAllowChangingDares=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strClean=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strDirty=[[[NSString alloc]initWithFormat:@"ON"]autorelease];
        NSString *strSuperDirty =[[[NSString alloc]initWithFormat:@"OFF"]autorelease];
        NSString *strTruthMode =[[[NSString alloc]initWithFormat:@"Off"]autorelease];
        NSString *strSpeed =[[[NSString alloc]initWithFormat:@"3"]autorelease];
        NSString *strAutoTruth =[[[NSString alloc]initWithFormat:@"6"]autorelease];
        NSString *strAutoTruthFlag=[[[NSString alloc]initWithFormat:@"YES"]autorelease];
        NSArray *objects = [NSArray arrayWithObjects:
                            strSound, 
                            strTakesTrueInOrder, 
                            strMyDaresOnly, 
                            strAllowChangingDares,
                            strClean,
                            strDirty,
                            strSuperDirty,
                            strTruthMode,
                            strSpeed,
                            strAutoTruth,
                            strAutoTruthFlag,
                            nil];
        NSArray *keys = [NSArray arrayWithObjects:@"Sound", @"Takes True In Order", @"My Dares Only", @"Allow Changing Dares", @"Clean", @"Dirty", @"Super Dirty", @"Truth Mode", @"Speed", @"Auto Truth",@"AutoTruthFlag",nil];
        
        if (dictSettings != nil)
        {
            dictSettings = nil;
        }
        dictSettings = [NSDictionary dictionaryWithObjects:objects forKeys:keys];
        [[UserDefaultSettings sharedSetting] storeDictionary:dictSettings withKey:@"Settings"];  
    }
    else
    {
        NSString *versionString = [[NSBundle mainBundle] objectForInfoDictionaryKey:(NSString*)kCFBundleVersionKey];
        NSString *AppVersion=[NSString stringWithFormat:@"Settings/AppVersion-%@",versionString];
        [FlurryAnalytics logEvent:AppVersion];
        
        NSString *strNumPlayers = [NSString stringWithFormat:@"Settings/NumPlayers-%d",[arrPlayers count]];
        [FlurryAnalytics logEvent:strNumPlayers];
        
        NSString *strSound1 = [NSString stringWithFormat:@"Settings/Sound-%@",[dictSettings valueForKey:@"Sound"]];
        [FlurryAnalytics logEvent:strSound1];
        
        NSString *strTakesTrueInOrder =[NSString stringWithFormat:@"Settings/RandomTurns-%@",[dictSettings valueForKey:@"Takes True In Order"]];
        [FlurryAnalytics logEvent:strTakesTrueInOrder];
        
        NSString *strMyDaresOnly = [NSString stringWithFormat:@"Settings/MyChallengesOnly-%@",[dictSettings valueForKey:@"My Dares Only"]];
        [FlurryAnalytics logEvent:strMyDaresOnly];
        
        NSString *strAllowChangingDares =[NSString stringWithFormat:@"Settings/IsDareChangeAllowed-%@",[dictSettings valueForKey:@"Allow Changing Dares"]];
        [FlurryAnalytics logEvent:strAllowChangingDares];
        
        NSString *strClean =[NSString stringWithFormat:@"Settings/IsCleanOn-%@", [dictSettings valueForKey:@"Clean"]];
        [FlurryAnalytics logEvent:strClean];
        
        NSString *strDirty =[NSString stringWithFormat:@"Settings/IsDirtyOn-%@", [dictSettings valueForKey:@"Dirty"]];
        [FlurryAnalytics logEvent:strDirty];
        
        NSString *strSuperDirty = [NSString stringWithFormat:@"Settings/IsSuperDirtyOn-%@",[dictSettings valueForKey:@"Super Dirty"]];
        [FlurryAnalytics logEvent:strSuperDirty];
        
        NSString *strSpeed = [NSString stringWithFormat:@"Settings/NumDaresPerLevel-%@",[dictSettings valueForKey:@"Speed"]];
        [FlurryAnalytics logEvent:strSpeed];
        
        NSString *strTruthMode =[NSString stringWithFormat:@"Settings/AutoTruthThreshold-%@",[dictSettings valueForKey:@"Auto Truth"] ];
        [FlurryAnalytics logEvent:strTruthMode];
        
        NSString *strAutoTruth = [NSString stringWithFormat:@"Settings/ShakeItUp-%@", [dictSettings valueForKey:@"Truth Mode"]];
        [FlurryAnalytics logEvent:strAutoTruth];
        
    }
    
    
    if([arrPlayers count] < 2)
    {
        strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Minimum two players", @"")];
        dictAlertMessage = [[NSMutableDictionary alloc] init];
        [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
        [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
        [dictAlertMessage release];
    }
    else
    {
        NSMutableArray *arr = [[NSMutableArray alloc] init];
        appDelegate.usedGender = arr;
        [arr release];
        
        PlayViewController *playObj;
        if(thisDevice.userInterfaceIdiom==UIUserInterfaceIdiomPad)
        {
            playObj = [[PlayViewController alloc] initWithNibName:@"PlayViewController_iPad" bundle:nil];
        }
        else
        {
            playObj = [[PlayViewController alloc] initWithNibName:@"PlayViewController" bundle:nil];
        }
        
        playObj.arrPlayerName = arrPlayers;
        playObj.arrPlayerGender = arrPlayersGender;
        appDelegate.stackArr = [NSMutableArray arrayWithArray:arrPlayers];
        appDelegate.stackGenderArr = [NSMutableArray arrayWithArray:arrPlayersGender];
        NSMutableArray *tempArr = [[NSMutableArray alloc] init];
        appDelegate.playerDetailsArray = tempArr;
        [tempArr release];
        
        for (int i=0; i<[arrPlayers count]; i++) 
        {
            NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
            [dict setObject:[arrPlayers objectAtIndex:i] forKey:@"Player"];
            [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"DareNumber"];
            [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"TruthNumber"];
            //------Speed--------------//
            [dict setObject:[NSString stringWithFormat:@"0"] forKey:@"SpeedNo"];
            [appDelegate.playerDetailsArray addObject:dict];
            [dict release];
        }
        
        [self.navigationController pushViewController:playObj animated:YES];
        [playObj release];
        
    }
    if(appDelegate.arrDirtinesNumber>0)
    {
        [appDelegate.arrDirtinesNumber removeAllObjects];
    }
    appDelegate.arrDirtinesNumber=[[NSMutableArray alloc]init];
    NSString *strClean = [dictSettings objectForKey:@"Clean"];
    NSString *strDirty = [dictSettings objectForKey:@"Dirty"];
    NSString *strSuperDirty = [dictSettings objectForKey:@"Super Dirty"];
    appDelegate.dirtinessLevel = 0;
    
    if([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
        appDelegate.dirtinessLevel = 3;
    else if(([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"]) || ([strClean isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"]) || ([strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"]))
        appDelegate.dirtinessLevel = 2;
    else 
        appDelegate.dirtinessLevel = 1;
    if(appDelegate.dirtinessLevel == 1)
    {
        if([strClean isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"1"];
            [appDelegate.arrDirtinesNumber addObject:@"2"];
            [appDelegate.arrDirtinesNumber addObject:@"3"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            appDelegate.dirtystartValue=1;
            appDelegate.Dirtyvalue=3;
            appDelegate.dirtystartValueformine=1;
        }
        else if([strDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"4"];
            [appDelegate.arrDirtinesNumber addObject:@"5"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            appDelegate.Dirtyvalue=5;
            appDelegate.dirtystartValue=4;
            appDelegate.dirtystartValueformine=4;
        }
        else if([strSuperDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"6"];
            appDelegate.dirtystartValue=6;
            appDelegate.Dirtyvalue=6;
            appDelegate.dirtystartValueformine=6;
        }
        
        
        
    }
    else if(appDelegate.dirtinessLevel == 2)
    {
        if([strClean isEqualToString:@"ON"]&&[strDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"1"];
            [appDelegate.arrDirtinesNumber addObject:@"2"];
            [appDelegate.arrDirtinesNumber addObject:@"3"];
            [appDelegate.arrDirtinesNumber addObject:@"4"];
            [appDelegate.arrDirtinesNumber addObject:@"5"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            appDelegate.dirtystartValue=1;
            appDelegate.Dirtyvalue=5;
            appDelegate.dirtystartValueformine=1;
        }
        else if([strClean isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"1"];
            [appDelegate.arrDirtinesNumber addObject:@"2"];
            [appDelegate.arrDirtinesNumber addObject:@"3"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"6"];
            appDelegate.dirtystartValue=1;
            appDelegate.Dirtyvalue=6;
            appDelegate.dirtystartValueformine=1;
            
            
        }
        else if([strDirty isEqualToString:@"ON"]&&[strSuperDirty isEqualToString:@"ON"])
        {
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"0"];
            [appDelegate.arrDirtinesNumber addObject:@"4"];
            [appDelegate.arrDirtinesNumber addObject:@"5"];
            [appDelegate.arrDirtinesNumber addObject:@"6"];
            appDelegate.dirtystartValue=4;
            appDelegate.Dirtyvalue=6;
            appDelegate.dirtystartValueformine=4;
            
        }
        
    }
    else if(appDelegate.dirtinessLevel == 3)
    {
        [appDelegate.arrDirtinesNumber addObject:@"1"];
        [appDelegate.arrDirtinesNumber addObject:@"2"];
        [appDelegate.arrDirtinesNumber addObject:@"3"];
        [appDelegate.arrDirtinesNumber addObject:@"4"];
        [appDelegate.arrDirtinesNumber addObject:@"5"];
        [appDelegate.arrDirtinesNumber addObject:@"6"];
        appDelegate.dirtystartValue=1;
        appDelegate.Dirtyvalue=6;
        appDelegate.dirtystartValueformine=1;
    }
    
    
}

#pragma mark popup delegate method
- (void)popupViewControllerDidClose:(NSString*)actionType withResponse:(BOOL)response
{
    
}
//textField delegate methods
#pragma mark - textField delegate methods
- (BOOL)textFieldShouldReturn:(UITextField *)textField 
{
	
    [textField resignFirstResponder];
    
	return YES;
}
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if ([textField.text length] > 25)
    {
        [txtPlayerName resignFirstResponder];
        strAlertMessage = [[NSString alloc]initWithString:NSLocalizedString(@"Maximum 25 char key", @"")];
        dictAlertMessage = [[NSMutableDictionary alloc] init];
        [dictAlertMessage setObject:strAlertMessage forKey:kPopupMessage];
        [Popup popUpWithMessage:dictAlertMessage delegate:self withType:nil];
        [dictAlertMessage release];
    }
    return YES;
    
}

//Table view delegate methods
#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [arrPlayers count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{  
    thisDevice = [UIDevice currentDevice];
    UIImageView *seprator;
    
    NSString *CellIdentifier = [NSString stringWithFormat:@"%d",indexPath.row];
    
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    cell = nil;
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    }
    
    if(indexPath.row == 0)
    {
        if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
        {
            seprator=[[UIImageView alloc]initWithFrame:CGRectMake(0, 0, 768, 6)]; 
        }
        else
        {
            seprator=[[UIImageView alloc]initWithFrame:CGRectMake(0, 0, 320, 3)];
        }
        [seprator setImage:[UIImage imageNamed:@"divider.png"]];
        [cell addSubview:seprator];
        [seprator release];
    }
    cell.textLabel.text = [arrPlayers objectAtIndex:indexPath.row];
    cell.textLabel.textColor = [UIColor whiteColor];
    cell.textLabel.textAlignment = UITextAlignmentLeft;
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        [cell.textLabel setFont: [UIFont fontWithName:@"Segoe Print" size:40.0]];          
    }
    else
    {    
        [cell.textLabel setFont: [UIFont fontWithName:@"Segoe Print" size:15.0]];
    }
    
    UIButton *btnGender = [UIButton buttonWithType:UIButtonTypeCustom];
    
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        btnGender.frame = CGRectMake(((tblPlayer.frame.size.width)-80- 100), 10, 80, 80);
        
        if([[arrPlayersGender objectAtIndex:indexPath.row] isEqualToString:@"Male"])
            [btnGender setImage:[UIImage imageNamed:@"malebtn_iPad.png"] forState:UIControlStateNormal];
        else
            [btnGender setImage:[UIImage imageNamed:@"femalebtn_iPad.png"] forState:UIControlStateNormal];    }
    else
    {
        btnGender.frame = CGRectMake(((tblPlayer.frame.size.width)-39- 65), 6, 39, 39);
        
        if([[arrPlayersGender objectAtIndex:indexPath.row] isEqualToString:@"Male"])
            [btnGender setImage:[UIImage imageNamed:@"malebtn.png"] forState:UIControlStateNormal];
        else
            [btnGender setImage:[UIImage imageNamed:@"femalebtn.png"] forState:UIControlStateNormal];
    }
    
    btnGender.tag = indexPath.row;
    [btnGender addTarget:self action:@selector(changeGender:) forControlEvents:UIControlEventTouchUpInside];
    [btnGender setUserInteractionEnabled:YES];
    [cell addSubview:btnGender];
    
    UIButton *btnDelete = [UIButton buttonWithType:UIButtonTypeCustom];
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        btnDelete.frame = CGRectMake(((tblPlayer.frame.size.width)-80-10),10,80,80);
        [btnDelete setImage:[UIImage imageNamed:@"deletebtn_iPad.png"] forState:UIControlStateNormal];
        
    }
    else
    {
        btnDelete.frame = CGRectMake(((tblPlayer.frame.size.width)-39-10),6,39,39);
        [btnDelete setImage:[UIImage imageNamed:@"deletebtn.png"] forState:UIControlStateNormal];
        
    }
    btnDelete.tag = indexPath.row;
    [btnDelete addTarget:self action:@selector(removePlayer:) forControlEvents:UIControlEventTouchUpInside];
    [btnDelete setUserInteractionEnabled:YES];
    [cell addSubview:btnDelete];
    
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        seprator=[[UIImageView alloc]initWithFrame:CGRectMake(0, 95, 768, 6)]; 
        
    }
    else
    {
        seprator=[[UIImageView alloc]initWithFrame:CGRectMake(0, 50, 320, 3)];
    }
    
    [seprator setImage:[UIImage imageNamed:@"divider.png"]];
    [cell addSubview:seprator];
    [seprator release];
    
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
    
    return cell; 
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    thisDevice = [UIDevice currentDevice];
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        return 95;
    }
    else
    {
        return 50;
    }
    
}

//Change Gender method
-(void)changeGender:(id)sender
{
    UIButton *btn = (UIButton *)sender;
    
    if(thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        if([btn.currentImage isEqual:[UIImage imageNamed:@"malebtn_iPad.png"]])
        {
            [btn setImage:[UIImage imageNamed:@"femalebtn_iPad.png"] forState:UIControlStateNormal];
            [arrPlayersGender replaceObjectAtIndex:btn.tag withObject:@"Female"];
            
            NSArray *arrGender = [NSArray arrayWithArray:arrPlayersGender];
            [[UserDefaultSettings sharedSetting] storeArray:arrGender withKey:@"Player Gender"];
            
        }
        else
        {
            [btn setImage:[UIImage imageNamed:@"malebtn_iPad.png"] forState:UIControlStateNormal];
            [arrPlayersGender replaceObjectAtIndex:btn.tag withObject:@"Male"];
            
            NSArray *arrGender = [NSArray arrayWithArray:arrPlayersGender];
            [[UserDefaultSettings sharedSetting] storeArray:arrGender withKey:@"Player Gender"];
        }
        
        
    }
    else
    {
        if([btn.currentImage isEqual:[UIImage imageNamed:@"malebtn.png"]])
        {
            [btn setImage:[UIImage imageNamed:@"femalebtn.png"] forState:UIControlStateNormal];
            [arrPlayersGender replaceObjectAtIndex:btn.tag withObject:@"Female"];
            
            NSArray *arrGender = [NSArray arrayWithArray:arrPlayersGender];
            [[UserDefaultSettings sharedSetting] storeArray:arrGender withKey:@"Player Gender"];
            
        }
        else
        {
            [btn setImage:[UIImage imageNamed:@"malebtn.png"] forState:UIControlStateNormal];
            [arrPlayersGender replaceObjectAtIndex:btn.tag withObject:@"Male"];
            
            NSArray *arrGender = [NSArray arrayWithArray:arrPlayersGender];
            [[UserDefaultSettings sharedSetting] storeArray:arrGender withKey:@"Player Gender"];
        }
    }
}
//Remove Player method
-(void)removePlayer:(id)sender
{
    UIButton *btn = (UIButton *)sender;
    [arrPlayers removeObjectAtIndex:btn.tag];
    [arrPlayersGender removeObjectAtIndex:btn.tag];
    
    NSArray *arrName = [NSArray arrayWithArray:arrPlayers];
    [[UserDefaultSettings sharedSetting] storeArray:arrName withKey:@"Player Name"];
    NSArray *arrGender = [NSArray arrayWithArray:arrPlayersGender];
    [[UserDefaultSettings sharedSetting] storeArray:arrGender withKey:@"Player Gender"];
    [FlurryAnalytics logEvent:@"PlayerRemoved"];
    [tblPlayer reloadData];
    
}


- (void)viewDidUnload
{
    [super viewDidUnload];
    
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}
-(void)dealloc
{
    
    self.tblPlayer = nil;
    self.txtPlayerName = nil;
    self.btnAddPlayer = nil;
    
    [arrPlayers release];
    [arrPlayersGender release];
}

@end
